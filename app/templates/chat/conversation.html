<ion-view title="对话">

  <ion-nav-buttons side="right">
    <button class="button button-icon dark icon ion-ios-search" ng-click="searchPopover.show($event)"></button>
  </ion-nav-buttons>

  <ion-content class="has-header">

    <!--<div class="note note-info padding" style="margin:10px;" ng-if="conversations.length === 0">-->
      <!--<h2 class="positive">No Messages</h2>-->
        <!--<p class="dark">Click on the chat button to start a conversation with a teacher</p>-->
    <!--</div>-->

    <div class="list">
      <div class="item item-avatar item-text-wrap"  ng-repeat="item in conversations  | filter: searchFilter " ng-click="goChat(item)">
        <img ng-src="{{item.master.recipientAvatar}}">
        <h2 class="lead">{{item.master.recipientName}}</h2>
        <p class="text-small" ng-if="_.values(item.slave).length">上条消息: {{_.values(item.slave)[_.values(item.slave).length -1].text}} <span ng-if="_.values(item.slave)[_.values(item.slave).length -1].imgUrl"><img width="80px"  ng-src="{{_.values(item.slave)[_.values(item.slave).length -1].imgUrl}}"/></span></p>
        <!--<i class="icon ion-ios-chatboxes-outline calm"><span class="text-smaller" countmessage='' message="{{_.values(item.slave)}}" time="{{item.master.lastLeaveAt}}"> </span></i>-->
        <i class="icon ion-ios-chatboxes-outline calm"><span class="text-smaller">  {{(_.values(item.slave) | filter : greaterThan('createAt', item.master.lastLeaveAt)).length }} 条未读消息</span></i>
        <span class="date calm">发送于 <span am-time-ago="_.values(item.slave)[_.values(item.slave).length -1].createAt"></span></span>
      </div>
    </div>

  </ion-content>


  <!--<a class="btn-floating btn-large waves-effect waves-light red" style="position:absolute; bottom:5%;right:5%;" ng-click="contactPopover.show($event);"><i class="icons ion-plus"></i></a>-->

</ion-view>
